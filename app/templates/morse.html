<!DOCTYPE html>
<html lang="en" id="morseHTML">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MORSE DECODER</title>

  <!-- Load CSS from style.css using jinja2 templating -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  <!-- Load Google Material Symbols fonten -->
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

  <!-- Modtag timestamps fra flask serveren og parse strengen til et JSON objekt -->
  <script>const timestamps = JSON.parse(`{{ timestamps | safe }}`);</script>

  <!-- K√∏r script fra morse.js ved hj√¶lp af jinja2 templating -->
  <script src="{{ url_for('static', filename='morse.js') }}" defer></script>
</head>
<body id="morseBody">

  <!-- Loading div -->
  <div id="loadingDisplay">

    <!-- Animeret loading icon -->
    <img src="{{ url_for('static', filename='loadingIcon.svg') }}" display="flex">
  </div>

  <!-- Title div -->
  <div id="title">
    <h1>MORSE DECODER</h1>
  </div>

  <!-- Div som indeholder alt det der har med visualisering at g√∏re -->
  <div id="morseVisual">

    <!-- Overskrift til visualisering -->
    <h1 id="visualText">VISUALIZED</h1>

    <!-- Video element, som looper, og lytter til om videoen trigger et af f√∏lgende events:
    oncanplaythrough, onplay, onpause, onended, onseeked og k√∏rer tilsvarende JS -->
    <!-- Videoen fjerner loading div'en n√•r den kan spille helt igennem uden at pause -->
    <!-- Videoen √¶ndrer knappen til pause n√•r videoen spiller -->
    <!-- Videoen √¶ndrer knappen til play n√•r videoen er paused -->
    <!-- Videoen s√¶tter triggeredIndexes til tom n√•r videoen er f√¶rdig -->
    <!-- Videoen s√¶tter lastTime til 0 n√•r videoen er f√¶rdig -->
    <!-- Videoen s√¶tter triggeredIndexes til tom n√•r videoen er seeked -->
    <!-- Videoen s√¶tter lastTime til videoens nuv√¶rende tid n√•r videoen er seeked -->
    <!-- Navn p√• videoen er hentet med jinja2 templating fra flask serveren -->
    <video id="morseBarDisplay" loop
    oncanplaythrough="document.getElementById('loadingDisplay').style.display='none';"
    onplay="document.getElementById('ppButton').innerText = '‚è∏';"
    onpause="document.getElementById('ppButton').innerText = '‚ñ∂';"
    onended="triggeredIndexes.clear(); lastTime = 0;"
    onseeked="lastTime = vid.currentTime; triggeredIndexes.clear();">
      <source src="{{ video_path }}" type="video/mp4">
    </video>

    <!-- Div som indeholder knapperne til at styre videoen -->
    <!-- Derudover ogs√• volume slideren -->
    <div id="controlPanel">

      <!-- Knap der starter og pauser videoen -->
      <button id="ppButton" class="button stopped round" onclick="vid.paused ? vid.play() : vid.pause();">‚ñ∂</button>

      <!-- Knap der stopper videoen og s√¶tter den tilbage til start ved brug af JS funktion -->
      <button id="stopButton" class="button round" onclick="stopVideo()">‚èπ</button>

      <!-- Div med volume slider og mute knap -->
      <!-- G√∏r brug af ikoner fra Google Material Symbols -->
      <!-- Volume slideren √¶ndrer lydstyrken p√• videoen -->
      <!-- Mute knappen √¶ndrer ikonet til volume_up eller volume_off alt efter om videoen er muted -->
      <div id="volumeControl">
        <button id="volumeButton" class="button round material-symbols-outlined" style="font-family: 'Material Symbols Outlined';" onclick="toggleMute()">volume_up</button>
        <input id="volumeSlider" type="range" min="0" max="1" step="0.01" value="0.5" oninput="setVolume(this.value)">
      </div>
    </div>
  </div>

  <!-- Div som indeholder output og knapper til at kopiere og slette -->
  <div id="morseOutDiv">

    <!-- Overskrift til output -->
    <h1 id="morseTitle">DECODED TEXT</h1>

    <!-- Tekstfelt til output -->
    <textarea name="text" id="morseOutput" placeholder="Decoded text will appear here" rows="14" cols="10" wrap="soft" maxlength="825"></textarea>

    <!-- Knapper til at kopiere og slette teksten i tekstfeltet -->
    <div id="morseOutButtons">

      <!-- Knap der kopierer teksten i tekstfeltet til clipboard -->
      <button id="copyButton" class="button round" onclick="navigator.clipboard.writeText(document.getElementById('morseOutput').value)">‚ßâ</button>

      <!-- Knap der sletter teksten i tekstfeltet -->
      <button id="clearButton" class="button round" onclick="document.getElementById('morseOutput').value = ''">üóë</button>
    </div>
  </div>

</body>
</html>
